<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ü–æ–π–º–∞–π —Ü–≤–µ—Ç–æ—á–µ–∫</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    html, body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      overflow: hidden;
    }
    /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –¥–≤—É–º—è —Å–ª–æ—è–º–∏: —Ä–∞–∑–º—ã—Ç–æ–π –ø–æ–¥–ª–æ–∂–∫–æ–π –∏ –æ—Å–Ω–æ–≤–Ω—ã–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º */
    #slideshow {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      overflow: hidden;
      background: #000;
    }
    /* –°–ª–æ–π —Ä–∞–∑–º—ã—Ç–æ–π –ø–æ–¥–ª–æ–∂–∫–∏ */
    #blurred-layer {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
    }
    #blurred-layer img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      filter: blur(20px);
      transform: scale(1.1); /* —Å–ª–µ–≥–∫–∞ —É–≤–µ–ª–∏—á–µ–Ω–æ, —á—Ç–æ–±—ã –∫—Ä–∞—è –Ω–µ –±—ã–ª–∏ –≤–∏–¥–Ω—ã */
      transition: opacity 1.5s ease;
      opacity: 0;
    }
    /* –°–ª–æ–π –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è */
    #foreground-layer {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
    }
    #foreground-layer img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: opacity 1.5s ease;
      opacity: 0;
    }
    /* –ê–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ —Å–∫–æ–ª—å–∂–µ–Ω–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è */
    .slide-ltr {
      animation: slideLeftToRight 8s linear forwards;
    }
    .slide-rtl {
      animation: slideRightToLeft 8s linear forwards;
    }
    @keyframes slideLeftToRight {
      0% { transform: translateX(-10%); }
      100% { transform: translateX(10%); }
    }
    @keyframes slideRightToLeft {
      0% { transform: translateX(10%); }
      100% { transform: translateX(-10%); }
    }
    #scoreboard {
      position: absolute;
      top: 10px;
      left: 10px;
      z-index: 10;
      font-size: 24px;
      background: rgba(0, 0, 0, 0.7);
      padding: 5px 10px;
      border-radius: 8px;
      color: #fff;
    }
    canvas {
      display: block;
    }
  </style>
</head>
<body>
  <div id="slideshow">
    <div id="blurred-layer"></div>
    <div id="foreground-layer"></div>
  </div>
  <div id="scoreboard">–°—á—ë—Ç: 0 | –ü—Ä–æ–º–∞—Ö–æ–≤: 0</div>
  <canvas id="gameCanvas"></canvas>
  
  <script>
    // –ú–∞—Å—Å–∏–≤ URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏)
    const bgImages = [
      'Images/photo1.jpg',
      'Images/photo2.jpg',
      'Images/photo3.jpg',
      'Images/photo4.jpg',
      'Images/photo5.jpg',
      'Images/photo6.jpg',
      'Images/photo7.jpg',
      'Images/photo8.jpg',
      'Images/photo9.jpg',
      'Images/photo10.jpg',
      'Images/photo11.jpg',
      'Images/photo12.jpg',
      'Images/photo13.jpg',
      'Images/photo14.jpg',
      'Images/photo15.jpg',
      'Images/photo16.jpg',
      'Images/photo17.jpg',
      'Images/photo18.jpg',
      'Images/photo19.jpg',
      'Images/photo20.jpg'
    ];
    
    // –ú–∞—Å—Å–∏–≤ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    const preloadedImages = [];
    let imagesLoaded = 0;
    const totalImages = bgImages.length;
    
    // –§—É–Ω–∫—Ü–∏—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
    function preloadImages(callback) {
      bgImages.forEach((src, index) => {
        const img = new Image();
        img.src = src;
        img.onload = () => {
          preloadedImages[index] = img;
          imagesLoaded++;
          if (imagesLoaded === totalImages) {
            callback();
          }
        };
        img.onerror = () => {
          console.error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: ${src}`);
          preloadedImages[index] = null;
          imagesLoaded++;
          if (imagesLoaded === totalImages) {
            callback();
          }
        };
      });
    }
    
    let currentForeground = null;
    let currentBlurred = null;
    const transitionTime = 1500; // –≤—Ä–µ–º—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ –º—Å
    
    // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑ –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö
    function getRandomImage() {
      const available = preloadedImages.filter(img => img !== null);
      if (!available.length) return null;
      const randomIndex = Math.floor(Math.random() * available.length);
      return available[randomIndex];
    }
    
    // –§—É–Ω–∫—Ü–∏—è —Å–º–µ–Ω—ã —Ñ–æ–Ω–∞: –æ–±–Ω–æ–≤–ª—è–µ–º –∏ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–ª–æ–π, –∏ —Å–ª–æ–π —Ä–∞–∑–º—ã—Ç–æ–π –ø–æ–¥–ª–æ–∂–∫–∏
    function showNextBackground() {
      const newImgObj = getRandomImage();
      if (!newImgObj) return;
      
      // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
      const newForegroundImg = document.createElement('img');
      newForegroundImg.src = newImgObj.src;
      newForegroundImg.style.opacity = "0";
      // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è
      const directionClass = Math.random() < 0.5 ? 'slide-ltr' : 'slide-rtl';
      newForegroundImg.classList.add(directionClass);
      document.getElementById('foreground-layer').appendChild(newForegroundImg);
      // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π reflow –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∞–Ω–∏–º–∞—Ü–∏–∏
      void newForegroundImg.offsetWidth;
      newForegroundImg.style.opacity = "1";
      
      // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è —Ä–∞–∑–º—ã—Ç–æ–π –ø–æ–¥–ª–æ–∂–∫–∏
      const newBlurredImg = document.createElement('img');
      newBlurredImg.src = newImgObj.src;
      newBlurredImg.style.opacity = "0";
      document.getElementById('blurred-layer').appendChild(newBlurredImg);
      void newBlurredImg.offsetWidth;
      newBlurredImg.style.opacity = "1";
      
      // –ü–ª–∞–≤–Ω–æ–µ —Å–∫—Ä—ã—Ç–∏–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
      if (currentForeground) {
        currentForeground.style.opacity = "0";
        setTimeout(() => {
          if (currentForeground && currentForeground.parentNode) {
            currentForeground.parentNode.removeChild(currentForeground);
          }
        }, transitionTime);
      }
      // –ü–ª–∞–≤–Ω–æ–µ —Å–∫—Ä—ã—Ç–∏–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Ä–∞–∑–º—ã—Ç–æ–π –ø–æ–¥–ª–æ–∂–∫–∏
      if (currentBlurred) {
        currentBlurred.style.opacity = "0";
        setTimeout(() => {
          if (currentBlurred && currentBlurred.parentNode) {
            currentBlurred.parentNode.removeChild(currentBlurred);
          }
        }, transitionTime);
      }
      
      currentForeground = newForegroundImg;
      currentBlurred = newBlurredImg;
    }
    
    // –ü–æ—Å–ª–µ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ–º —Å–ª–∞–π–¥—à–æ—É
    preloadImages(() => {
      showNextBackground();
      setInterval(showNextBackground, 8000);
    });
    
    // ==== –ò–≥—Ä–æ–≤–æ–π –∫–æ–¥ (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ====
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const scoreboard = document.getElementById('scoreboard');
    
    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();
    
    let score = 0;
    let misses = 0;
    let gameOver = false;
    const emojis = [];
    const emojiSize = 50;
    const flowerExtraMargin = 30; 
    const normalExtraMargin = 10;
    
    const randomEmojis = ['üòÄ','üòÇ','üòç','üòé','ü§ñ','üçé','üçî','‚öΩ','üéà','üöó','üåü','üçÄ'];
    
    function spawnEmoji() {
      const isFlower = Math.random() < 0.3;
      const char = isFlower ? 'üå∏' : randomEmojis[Math.floor(Math.random() * randomEmojis.length)];
      const baseX = emojiSize / 2 + Math.random() * (canvas.width - emojiSize);
      const amplitude = 30 + Math.random() * 20;  
      const period = 100 + Math.random() * 100;     
      const speed = 2 + Math.random() * 3;
      emojis.push({
        baseX: baseX,
        x: baseX,
        y: -emojiSize / 2,
        amplitude: amplitude,
        period: period,
        speed: speed,
        isFlower: isFlower,
        char: char
      });
    }
    
    function handleHit(clickX, clickY) {
      for (let i = emojis.length - 1; i >= 0; i--) {
        const emoji = emojis[i];
        emoji.x = emoji.baseX + emoji.amplitude * Math.sin(emoji.y / emoji.period);
        const centerX = emoji.x;
        const centerY = emoji.y;
        const extraMargin = emoji.isFlower ? flowerExtraMargin : normalExtraMargin;
        const hitRadius = emojiSize / 2 + extraMargin;
        const distance = Math.hypot(clickX - centerX, clickY - centerY);
        if (distance <= hitRadius) {
          if (emoji.isFlower) {
            score++;
          } else {
            misses++;
          }
          emojis.splice(i, 1);
          break;
        }
      }
      updateScoreboard();
      checkGameOver();
    }
    
    canvas.addEventListener('click', function(e) {
      if (gameOver) return;
      const rect = canvas.getBoundingClientRect();
      const clickX = e.clientX - rect.left;
      const clickY = e.clientY - rect.top;
      handleHit(clickX, clickY);
    });
    
    canvas.addEventListener('touchstart', function(e) {
      if (gameOver) return;
      e.preventDefault();
      const rect = canvas.getBoundingClientRect();
      const touch = e.changedTouches[0];
      const clickX = touch.clientX - rect.left;
      const clickY = touch.clientY - rect.top;
      handleHit(clickX, clickY);
    });
    
    function updateScoreboard() {
      scoreboard.innerText = `–°—á—ë—Ç: ${score} | –ü—Ä–æ–º–∞—Ö–æ–≤: ${misses}`;
    }
    
    function checkGameOver() {
      if (misses >= 3) {
        gameOver = true;
        setTimeout(() => {
          alert("–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –í–∞—à —Å—á—ë—Ç: " + score);
          resetGame();
        }, 10);
      }
    }
    
    function resetGame() {
      score = 0;
      misses = 0;
      emojis.length = 0;
      gameOver = false;
      updateScoreboard();
    }
    
    function update() {
      if (!gameOver && Math.random() < 0.03) {
        spawnEmoji();
      }
      
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.font = emojiSize + "px serif";
      ctx.textAlign = "center";
      ctx.textBaseline = "middle";
    
      for (let i = emojis.length - 1; i >= 0; i--) {
        const emoji = emojis[i];
        emoji.x = emoji.baseX + emoji.amplitude * Math.sin(emoji.y / emoji.period);
        emoji.y += emoji.speed;
        ctx.fillText(emoji.char, emoji.x, emoji.y);
        if (emoji.y - emojiSize / 2 > canvas.height) {
          if (emoji.isFlower) {
            misses++;
          }
          emojis.splice(i, 1);
          updateScoreboard();
          checkGameOver();
        }
      }
      
      requestAnimationFrame(update);
    }
    
    update();
  </script>
</body>
</html>
